{"ast":null,"code":"import { takeLatest, put, call } from \"redux-saga/effects\";\nimport { toast } from \"react-toastify\";\nimport { login, refreshToken, logout } from \"../../apiServices\";\nimport { loginSuccess, getNewTokenSuccess, logoutSucess } from \"../actions/authenticateAction\";\nimport { authenticateConstant } from \"../../constants\";\nconst {\n  LOGIN,\n  GET_NEW_TOKEN,\n  LOGOUT\n} = authenticateConstant;\nfunction* postLoginForm(action) {\n  const {\n    payload\n  } = action;\n  try {\n    const {\n      status,\n      data\n    } = yield call(login, payload);\n    if (status === 200) {\n      yield put(loginSuccess(data));\n      return;\n    } else if (status === 400) {\n      return toast.error(data.message);\n    } else {\n      return toast.error(\"Unauthorize\");\n    }\n  } catch (error) {\n    console.log(error);\n  }\n}\nfunction* getNewToken() {\n  const {\n    data,\n    status\n  } = yield call(refreshToken);\n  if (status === 200) {\n    yield put(getNewTokenSuccess(data));\n  } else {\n    yield put(logoutSucess());\n  }\n}\nfunction* revokeTokenAndLogout(action) {\n  const {\n    payload\n  } = action;\n  const {\n    status\n  } = yield call(logout, payload);\n  if (status === 200) {\n    yield put(logoutSucess());\n  }\n}\nexport default function* authenticateSaga() {\n  yield takeLatest(LOGIN, postLoginForm);\n  yield takeLatest(GET_NEW_TOKEN, getNewToken);\n  yield takeLatest(LOGOUT, revokeTokenAndLogout);\n}","map":{"version":3,"names":["takeLatest","put","call","toast","login","refreshToken","logout","loginSuccess","getNewTokenSuccess","logoutSucess","authenticateConstant","LOGIN","GET_NEW_TOKEN","LOGOUT","postLoginForm","action","payload","status","data","error","message","console","log","getNewToken","revokeTokenAndLogout","authenticateSaga"],"sources":["E:/1640-ENTERPRISE/COMP_WEB/front_End/src/store/saga/auth.saga.js"],"sourcesContent":["import { takeLatest, put, call } from \"redux-saga/effects\";\r\nimport { toast } from \"react-toastify\";\r\n\r\nimport { login, refreshToken, logout } from \"../../apiServices\";\r\nimport {\r\n  loginSuccess,\r\n  getNewTokenSuccess,\r\n  logoutSucess,\r\n} from \"../actions/authenticateAction\";\r\nimport { authenticateConstant } from \"../../constants\";\r\n\r\nconst { LOGIN, GET_NEW_TOKEN, LOGOUT } = authenticateConstant;\r\n\r\nfunction* postLoginForm(action) {\r\n  const { payload } = action;\r\n  try {\r\n    const { status, data } = yield call(login, payload);\r\n    if (status === 200) {\r\n      yield put(loginSuccess(data));\r\n      return;\r\n    } else if(status === 400) {\r\n      return toast.error(data.message);\r\n    } else {\r\n      return toast.error(\"Unauthorize\");\r\n    }\r\n  } catch (error) {\r\n    console.log(error);\r\n  }\r\n}\r\n\r\nfunction* getNewToken() {\r\n  const { data, status } = yield call(refreshToken);\r\n  if(status === 200) {\r\n    yield put(getNewTokenSuccess(data));\r\n  }\r\n  else {\r\n    yield put(logoutSucess());\r\n  }\r\n}\r\n\r\nfunction* revokeTokenAndLogout(action) {\r\n  const {payload} = action;\r\n  const {status} = yield call(logout, payload);\r\n  if(status === 200) { \r\n    yield put(logoutSucess());\r\n  }\r\n}\r\n\r\nexport default function* authenticateSaga() {\r\n  yield takeLatest(LOGIN, postLoginForm);\r\n  yield takeLatest(GET_NEW_TOKEN, getNewToken);\r\n  yield takeLatest(LOGOUT, revokeTokenAndLogout);\r\n}\r\n"],"mappings":"AAAA,SAASA,UAAU,EAAEC,GAAG,EAAEC,IAAI,QAAQ,oBAAoB;AAC1D,SAASC,KAAK,QAAQ,gBAAgB;AAEtC,SAASC,KAAK,EAAEC,YAAY,EAAEC,MAAM,QAAQ,mBAAmB;AAC/D,SACEC,YAAY,EACZC,kBAAkB,EAClBC,YAAY,QACP,+BAA+B;AACtC,SAASC,oBAAoB,QAAQ,iBAAiB;AAEtD,MAAM;EAAEC,KAAK;EAAEC,aAAa;EAAEC;AAAO,CAAC,GAAGH,oBAAoB;AAE7D,UAAUI,aAAaA,CAACC,MAAM,EAAE;EAC9B,MAAM;IAAEC;EAAQ,CAAC,GAAGD,MAAM;EAC1B,IAAI;IACF,MAAM;MAAEE,MAAM;MAAEC;IAAK,CAAC,GAAG,MAAMhB,IAAI,CAACE,KAAK,EAAEY,OAAO,CAAC;IACnD,IAAIC,MAAM,KAAK,GAAG,EAAE;MAClB,MAAMhB,GAAG,CAACM,YAAY,CAACW,IAAI,CAAC,CAAC;MAC7B;IACF,CAAC,MAAM,IAAGD,MAAM,KAAK,GAAG,EAAE;MACxB,OAAOd,KAAK,CAACgB,KAAK,CAACD,IAAI,CAACE,OAAO,CAAC;IAClC,CAAC,MAAM;MACL,OAAOjB,KAAK,CAACgB,KAAK,CAAC,aAAa,CAAC;IACnC;EACF,CAAC,CAAC,OAAOA,KAAK,EAAE;IACdE,OAAO,CAACC,GAAG,CAACH,KAAK,CAAC;EACpB;AACF;AAEA,UAAUI,WAAWA,CAAA,EAAG;EACtB,MAAM;IAAEL,IAAI;IAAED;EAAO,CAAC,GAAG,MAAMf,IAAI,CAACG,YAAY,CAAC;EACjD,IAAGY,MAAM,KAAK,GAAG,EAAE;IACjB,MAAMhB,GAAG,CAACO,kBAAkB,CAACU,IAAI,CAAC,CAAC;EACrC,CAAC,MACI;IACH,MAAMjB,GAAG,CAACQ,YAAY,CAAC,CAAC,CAAC;EAC3B;AACF;AAEA,UAAUe,oBAAoBA,CAACT,MAAM,EAAE;EACrC,MAAM;IAACC;EAAO,CAAC,GAAGD,MAAM;EACxB,MAAM;IAACE;EAAM,CAAC,GAAG,MAAMf,IAAI,CAACI,MAAM,EAAEU,OAAO,CAAC;EAC5C,IAAGC,MAAM,KAAK,GAAG,EAAE;IACjB,MAAMhB,GAAG,CAACQ,YAAY,CAAC,CAAC,CAAC;EAC3B;AACF;AAEA,eAAe,UAAUgB,gBAAgBA,CAAA,EAAG;EAC1C,MAAMzB,UAAU,CAACW,KAAK,EAAEG,aAAa,CAAC;EACtC,MAAMd,UAAU,CAACY,aAAa,EAAEW,WAAW,CAAC;EAC5C,MAAMvB,UAAU,CAACa,MAAM,EAAEW,oBAAoB,CAAC;AAChD","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}